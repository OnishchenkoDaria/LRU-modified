# Політика заміни кешу AGING

## Вступ

Політика **AGING** — це вдосконалений підхід до керування обмеженою пам'яттю кешу, яка відстежує "вік" сторінок. Вона має на меті замінювати сторінки, які не використовуються найдовше, надаючи перевагу довгостроковій бездіяльності, а не лише останнім зверненням, що є компромісом між простотою та ефективністю, і є надійним вибором для багатьох сценаріїв управління кешем.

## Теорія та ідея політики AGING

Політика **AGING** працює за принципом присвоєння кожній сторінці кешу числового параметру *"віку"*. Якщо до сторінки не взертаються, тоді вік збільшується. А якщо сторінка використовується, то її вік скидається до нуля. Коли потрібно замінити сторінку, вибирається та, що має найвищий вік (тобто найбільш "стару").

### Ключові концепції
1. **Лічильник віку**: Кожна сторінка має асоційований лічильник, що відстежує, як довго вона не була використана.
2. **Інкремент віку**: Через певні інтервали часу або після кожної операції вік всіх сторінок збільшується на 1.
3. **Прийняття рішення щодо заміни**: Коли кеш заповнений, замінюється сторінка з найвищим віком.
4. **Скидання при зверненні**: Коли сторінка звертається, її лічильник віку скидається на 0.

---

## Реалізація AGING

Ось тезисний опис того, як політика **AGING** реалізується програмно:

1. **Структури даних**:
   - Використовуємо масив або словник для зберігання сторінок і їхніх віків.
   - Можна додатково зберігати метадані сторінок для налагодження чи оптимізації.

2. **Основні кроки**:
   - **Звернення до сторінки**: Коли сторінка звертається:
     - Якщо сторінка є в кеші, її вік скидається на 0.
     - Якщо її немає в кеші:
       - Перевіряється, чи є місце в кеші.
       - Якщо кеш заповнений, вибирається сторінка з найвищим віком для заміни.
       - Додається нова сторінка з віком 0.
   - **Інкремент віку**: Після кожної операції або циклу інкрементується вік усіх сторінок, які не були використані.

## Порівняння з іншими політиками
### AGING vs. LRU (Останнє нещодавнє використання):
- **LRU** орієнтується лише на останнє використання сторінки, видаляючи сторінку, яку не використовували найостанніше.
- **AGING** враховує як останнє використання, так і довгострокову бездіяльність через підрахунок віку сторінок.
- **Перевага AGING:** краще працює в ситуаціях, коли патерни звернення до сторінок непередбачувані або циклічні, адже запобігає передчасній заміні сторінок, що використовуються час від часу.

### AGING vs. FIFO (Перший на вході — перший на виході):
- **FIFO** замінює сторінку, яка була додана в кеш найраніше, без урахування того, скільки разів вона використовувалася.
- **AGING** інтелектуально замінює сторінки на основі їх активності, а не часу їх додавання.
- **Перевага AGING:** уникає передчасної заміни активно використовуваних сторінок.

### AGING vs. CLOCK:
- **CLOCK** використовує один біт доступу, щоб визначити, чи була сторінка "нещодавно використана".
- **AGING** використовує більше бітів (або лічильників) для відстеження активності сторінок з більшою точністю.
- **Перевага AGING:** забезпечує більш тонке управління заміною сторінок, особливо у складних робочих навантаженнях.

---

## Коли використовувати AGING
Політика AGING ефективна в таких випадках:

1. **Непередбачувані патерни доступу:** коли звернення до сторінок є нерегулярними.
2. **Робочі навантаження з тимчасовою локальністю:** якщо певні сторінки активно використовуються певний час, а потім довгий час не використовуються, AGING забезпечує їх заміну.
3. **Великі системи кешу:** Політика AGING працює добре в системах з великими кешами, де відстеження точного порядку звернень (як у LRU) може бути дорогим.
4. **Збалансовані системи:** якщо для робочого навантаження важливо враховувати як останнє використання, так і тривалу бездіяльність, AGING забезпечує оптимальний компроміс.

---

## Приклад роботи AGING
### Сценарій:
- **Розмір кешу:** 3
- **Послідовність звернень:** `[0, 1, 2, 0, 1, 3, 0, 3, 1, 2, 1]`
### Покрокове виконання:

| Звернення | Стан кешу    | Дія   | Видалена сторінка | Віки сторінок |
|-----------|--------------|-------|-------------------|---------------|
| 0         | [0]          | MISS  | -                 | [0]           |
| 1         | [0, 1]       | MISS  | -                 | [1, 0]        |
| 2         | [0, 1, 2]    | MISS  | -                 | [2, 1, 0]     |
| 0         | [0, 1, 2]    | HIT   | -                 | [0, 2, 1]     |
| 1         | [0, 1, 2]    | HIT   | -                 | [1, 0, 2]     |
| 3         | [3, 1, 2]    | MISS  | 0                 | [0, 1, 2]     |
| ...       | ...          | ...   | ...               | ...           |

Наприкінці політика AGING досягає **показника хітів 54,55%**, що є порівнянним з LRU, але при цьому показує кращу стабільність у випадку нерегулярних патернів доступу.

---

## Переваги AGING

1. Відстежує довгострокову бездіяльність, запобігаючи передчасній заміні сторінок.
2. Добре адаптується до непередбачуваних або змішаних патернів доступу.
3. Забезпечує збалансований підхід між простими та більш складними алгоритмами, такими як LRU чи FIFO.

---

## Недоліки

1. Вимагає трохи більших обчислювальних ресурсів через необхідність відстеження віку всіх сторінок.
2. Менш ефективна для робочих навантажень із чіткою та передбачуваною локальністю.

---

## Висновок

Політика **AGING** є потужною стратегією заміни кешу, яка збалансовує простоту та ефективність. Вона враховує як останнє використання сторінок, так і довгострокову бездіяльність, що робить її придатною для різноманітних та динамічних workloads.

---

Детальніше про використання політик заміни сторінок можна дізнатися в [README.org.md](README.org.md).